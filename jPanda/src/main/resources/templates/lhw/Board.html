<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<script src="/js/jquery.js"></script>
<style type="text/css">
/* 페이지 전체 레이아웃 */
body {
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;
}

/* 공통 스타일 */
ul, li {
  list-style: none;
  margin: 0;
  padding: 0;
}

/* 헤더 */
header {
  background-color: #333;
  color: #fff;
  padding: 20px;
}

/* 메뉴 */
nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 10px 0;
}

nav ul {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
}

nav li {
  margin: 0 10px;
}

nav a {
  color: #fff;
}

/* 게시판 리스트 */
#list-container {
  margin: 80px auto;
  max-width: 800px;
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
}

/* 게시글 목록 */
li {
  border: 1px solid #ccc;
  margin: 20px 10px;
  margin-bottom: 10px;
  padding: 10px;
  text-align: center;
  flex-basis: 48%;
}

li:hover {
  background-color: #f2f2f2;
}

/* 검색 */
.search {
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
}

/* 사이드바 대분류 카테고리 */
#top-category {
  position: absolute;
  float: left;
  left: 20px;
  top: 200px;
  width: 200px;
  border: solid 1px;
  margin-left: 20px;
}

/* 중분류 카테고리 */
#lower-category {
  text-align: center;
  margin: 0 auto;
  max-width: 800px;
}

/* 로고 */
#logo {
  float: left;
  width: 200px;
  border: solid 1px;
  margin-left: 20px;
}

/* 공지사항 */
#notice {
  margin-bottom: 20px;
}

</style>

    <title>게시판 페이지</title>
</head>
<body>
<header>
        <div id="logo">로고</div>
        
        <div class="search">
                <input type="text" placeholder="검색어를 입력하세요">
                <button>검색</button>
            </div>
            
        <nav>
            <ul>
                <li><a href="#">판매 등록</a></li>
                <li><a href="#">판매 게시판</a></li>
                <li><a href="#">거래 관리</a></li>
                <li><a href="#">충전 및 내역</a></li>
                <li><a href="#">문의</a></li>
                <li><a href="#">마이 페이지</a></li>
            </ul>
        </nav>
</header>
    
    <div id="top-category">
    	<h2>대분류 카테고리</h2>
    	<ul th:each="upperCategory : ${upperCategoryList}">	
    		<li th:text="${upperCategory.item}" th:onclick="onFilter([[${upperCategory.categoryNo}]])"></li>
    	</ul>
    </div>
    
    <div id="lower-category">
    	<h2>중분류 카테고리</h2>
			<select id="lower-category-list">
  				<option>==대분류를 선택해주세요==</option>
			</select> <br>
			
			<input type="checkbox" id="checkbox1" name="group" value="value1">
			<label for="checkbox1">최신순</label>
			
			<input type="checkbox" id="checkbox2" name="group" value="value2">
			<label for="checkbox2">인기순</label><br>
			
			<input type="checkbox" id="checkbox3" name="group" value="value3">
			<label for="checkbox3">평점순</label>
			
			<input type="checkbox" id="checkbox4" name="group" value="value4">
			<label for="checkbox4">높은 가격순</label><br>
			
			<input type="checkbox" id="checkbox5" name="group" value="value5">
			<label for="checkbox5">낮은 가격순</label><br>
			<button onclick="applyChanges()">적용</button>
    </div>
    
	<div id="list-container">
	   	<div class="list">
	   		<h2>공지사항 리스트</h2>
	   		 <ul id="notice-list">
	        	<li th:each="notice : ${noticeList}">
	                <span th:text="${notice.noticeNo}"></span>
	                <span th:text="${notice.title}"></span>
	                <span th:text="${notice.regDate}"></span>
	        	</li>
	         </ul>
		</div>
	<button>판매글 등록</button>
	     <div class="list">
	        <h2>판매 게시판 리스트</h2>
	        	<ul id="defalut-list">
	            	<li th:each="talent : ${talentList}" th:onclick="|location.href='/talent/${talent.talentNo}'|">
	               		이미지:	<img th:src="${talent.mainImg}">
	                	제목:		<span th:text="${talent.title}"></span><p>
	                	요약설명:	<span th:text="${talent.summary}"></span><p>
	                	강사:		<span th:text="${talent.sellerId}"></span>
	                	정상 가격:	<span th:text="${talent.bamboo}"></span><p>
	                	판매 가격:	<span th:text="${talent.saleBamboo}"></span><p>
				           		<span class="avgScoreSpan" th:text="${talent.bambooScore}">
								</span>
								<img >
	            	</li>
	        	</ul>
	     </div>
	</div>

<script type="text/javascript" src="/js/jquery.js"></script>
<script>
function onFilter(upperCategoryNo){
    $.ajax({
        url:"/board/update-talent-list-by-upper-category-no",
        type: 'get',
        data: { upperCategoryNo: upperCategoryNo},
        dataType:'json',
        success:function(talentList){
            $('#defalut-list').empty();
            console.log(talentList);
            talentList.forEach(function(talent){
                const li = $('<li>').appendTo('#defalut-list');
                $('<img>').attr('src', talent.mainImg).appendTo(li);
                $('<span>').addClass('title').text(talent.title).appendTo(li);
                $('<span>').text(talent.summary).appendTo(li);
                $('<span>').text(talent.sellerId).appendTo(li);
                $('<span>').text(talent.bamboo).appendTo(li);
                $('<span>').text(talent.saleBamboo).appendTo(li);
                $('<span>').text(talent.bambooScore).appendTo(li);
                li.click(function() {
                    location.href = '/talent/' + talent.talentNo;
                });
            });
        }
    });
    
    $.ajax({
    	url:"/board/update-lower-category-list-by-upper-category-no",
        type: 'get',
    	data: {upperCategoryNo : upperCategoryNo},
    	dataType:'json',
    	success:function(lowerCategoryList){
    		console.log(lowerCategoryList);
    		$('#lower-category-list').empty();
    		$('#lower-category-list').append($('<option>').text('==중분류 선택=='));
    		lowerCategoryList.forEach(function(lowerCategory){
    			$('#lower-category-list').append($('<option>').val(lowerCategory.categoryNo).text(lowerCategory.item));
    		});
    	}
    });
}



	$('#lower-category-list').on('change', function() { 
		var lowerCategoryNo = $(this).val();
		$.ajax({
			url:"/board/update-talent-list-by-lower-category-no",
	        type: 'get',
			data: {lowerCategoryNo : lowerCategoryNo},
			dataType:'json',
			success:function(talentList){
	            $('#defalut-list').empty();
	            console.log(talentList);
	            talentList.forEach(function(talent){
	                const li = $('<li>').appendTo('#defalut-list');
	                $('<img>').attr('src', talent.mainImg).appendTo(li);
	                $('<span>').addClass('title').text(talent.title).appendTo(li);
	                $('<span>').text(talent.summary).appendTo(li);
	                $('<span>').text(talent.sellerId).appendTo(li);
	                $('<span>').text(talent.bamboo).appendTo(li);
	                $('<span>').text(talent.saleBamboo).appendTo(li);
	                $('<span>').text(talent.bambooScore).appendTo(li);
	                li.click(function() {
	                    location.href = '/talent/' + talent.talentNo;
	                });
	            });
	        }
		});
	});

	
	
	
const checkboxes = document.querySelectorAll('input[name=group]');
  checkboxes.forEach((checkbox) => {
    checkbox.addEventListener('change', function() {
      checkboxes.forEach((c) => {
        if (c !== this) {
          c.checked = false;
        }
      });
    });
  });

  function applyChanges() {
    // 체크박스가 선택된 상태에서 적용 버튼을 눌렀을 때의 동작
  }
 

  
$(function() {
	  var starImages = ['bamboo1star.png', 'bamboo2star.png', 'bamboo3star.png', 'bamboo4star.png', 'bamboo5star.png'];
	  var avgScoreSpan = $('.avgScoreSpan');
	  var avgScoreImg = document.getElementById('avgScoreImg');
	  var avgScore = parseInt(avgScoreSpan.innerText);
	  $('.avgScoreSpan').each(function(){
		  	var score = parseInt($(this).text());
		  	$(this).next('img').attr('src', '../images/bambooScore/' + starImages[score - 1]);
	  });
	});
</script>
</body>
</html>
