<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<script src="/js/jquery.js"></script>
<style type="text/css">
/* 페이지 전체 레이아웃 */
body {
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;
}

/* 공통 스타일 */
ul, li {
  list-style: none;
  margin: 0;
  padding: 0;
}

/* 헤더 */
header {
  background-color: #333;
  color: #fff;
  padding: 20px;
}

/* 메뉴 */
nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 10px 0;
}

nav ul {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
}

nav li {
  margin: 0 10px;
}

nav a {
  color: #fff;
}

/* 게시판 리스트 */
#list-container {
  margin: 80px auto;
  max-width: 800px;
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
}

/* 게시글 목록 */
li {
  border: 1px solid #ccc;
  margin: 20px 10px;
  margin-bottom: 10px;
  padding: 10px;
  text-align: center;
  flex-basis: 48%;
}

li:hover {
  background-color: #f2f2f2;
}

/* 검색 */
.search {
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
}

/* 사이드바 대분류 카테고리 */
#top-category {
  position: absolute;
  float: left;
  left: 20px;
  top: 200px;
  width: 200px;
  border: solid 1px;
  margin-left: 20px;
}

/* 중분류 카테고리 */
#lower-category {
  text-align: center;
  margin: 0 auto;
  max-width: 800px;
}

/* 로고 */
#logo {
  float: left;
  width: 200px;
  border: solid 1px;
  margin-left: 20px;
}

/* 공지사항 */
#notice {
  margin-bottom: 20px;
}

.bamboo-score {
  width: 80px; /* 별점 이미지 하나당 16px이므로 5개의 별점을 표시하기 위해 80px 지정 */
  height: 16px;
}

.bamboo-score img {
  width: 16px;
  height: 16px;
}



.talent-ajax-list {
  margin: 80px auto;
  max-width: 800px;
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
}

.talent-image {
  max-width: 100px;
  margin-right: 10px;
}

.talent-title {
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 5px;
}

.talent-summary {
  font-size: 14px;
  margin-bottom: 5px;
}

.talent-seller {
  font-size: 12px;
  color: gray;
  margin-right: 10px;
}

.talent-price {
  font-size: 18px;
  margin-right: 10px;
  text-decoration: line-through;
  color: red;
}

.talent-sale-price {
  font-size: 18px;
  color: green;
  font-weight: bold;
  margin-right: 10px;
}

.talent-score {
  font-size: 12px;
  color: green;
}


</style>

    <title>게시판 페이지</title>
</head>
<body>
<header>
        <div id="logo">로고</div>
        
        <div class="search">
                <input type="text" placeholder="검색어를 입력하세요">
                <button>검색</button>
            </div>
            
        <nav>
            <ul>
                <li><a href="#">판매 등록</a></li>
                <li><a href="#">판매 게시판</a></li>
                <li><a href="#">거래 관리</a></li>
                <li><a href="#">충전 및 내역</a></li>
                <li><a href="#">문의</a></li>
                <li><a href="#">마이 페이지</a></li>
            </ul>
        </nav>
</header>
    
    <div id="top-category">
    	<h2>대분류 카테고리</h2>
    	<ul th:each="upperCategory : ${upperCategoryList}">	
    		<li class="topCategoryList" th:text="${upperCategory.item}" th:onclick="onFilter([[${upperCategory.categoryNo}]])"></li>
    	</ul>
    </div>
    
    <div id="lower-category">
    	<h2>중분류 카테고리</h2>
			<select id="lower-category-list">
  				<option>==대분류를 선택해주세요==</option>
			</select> <br>
			
			<input type="radio" id="radio1" name="group" class="radio-filter" value="req_date" checked="checked" onclick="filters()">
			<label for="radio1">최신순</label>
			
			<input type="radio" id="radio2" name="group" class="radio-filter" value="view_count" onclick="filters()">
			<label for="radio2">인기순</label><br>
			
			<input type="radio" id="radio3" name="group" class="radio-filter" value="bamboo_score" onclick="filters()">
			<label for="radio3">평점순</label>
			
			<input type="radio" id="radio4" name="group" class="radio-filter" value="sale_bamboo" onclick="filters()">
			<label for="radio4">높은 가격순</label><br>
			
			<input type="radio" id="radio5" name="group" class="radio-filter" value="sale_bamboo" onclick="filters()">
			<label for="radio5">낮은 가격순</label><br>
    </div>
    
    

    
	<div id="list-container">
	   	<div class="list">
	   		<h2>공지사항 리스트</h2>
	   		 <ul id="notice-list">
	        	<li th:each="notice : ${noticeList}">
	                <span th:text="${notice.noticeNo}"></span>
	                <span th:text="${notice.title}"></span>
	                <span th:text="${notice.regDate}"></span>
	        	</li>
	         </ul>
		</div>
		<button id="sell-insert">판매글 등록</button>
	     <div class="list">
	        <h2>판매 게시판 리스트</h2>
	        	<ul id="defalut-list">
	            	<li th:each="talent : ${talentList}" th:onclick="|location.href='/talent/talents/${talent.talentNo}'|">
	               		이미지:	<img th:src="${talent.mainImg}">
	                	제목:		<span th:text="${talent.title}"></span><p>
	                	요약설명:	<span th:text="${talent.summary}"></span><p>
	                	강사:		<span th:text="${talent.sellerId}"></span><p>
	                	정상 가격:	<span th:text="${talent.bamboo}"></span><p>
	                	판매 가격:	<span th:text="${talent.saleBamboo}"></span><p>
				           		<span class="avgScoreSpan" th:text="${talent.bambooScore}"> <!-- style="display:none;" --></span>
						만족도:	<img class="bamboo-score">

	            	</li>
	        	</ul>
	     </div>
	</div>

<form action="" method="get">
</form>

<script type="text/javascript" src="/js/jquery.js"></script>
<script>

function onFilter(upperCategoryNo){
	
    $.ajax({
        url:"/board/update-talent-list-by-upper-category-no",
        type: 'get',
        data: { upperCategoryNo: upperCategoryNo},
        dataType:'json',
        success:function(talentList){
            $('#defalut-list').empty();
            console.log(talentList);
            talentList.forEach(function(talent){
            	const li = $('<li>').appendTo('#defalut-list').addClass('talent-ajax-list');
            	$('<img>').attr('src', talent.mainImg).addClass('talent-image').appendTo(li);
            	$('<span>').addClass('talent-title').text(talent.title).appendTo(li);
            	$('<span>').addClass('talent-summary').text(talent.summary).appendTo(li);
            	$('<span>').addClass('talent-seller').text(talent.sellerId).appendTo(li);
            	$('<span>').addClass('talent-price').text(talent.bamboo).appendTo(li);
            	$('<span>').addClass('talent-sale-price').text(talent.saleBamboo).appendTo(li);
            	$('<span>').addClass('avgScoreSpan').text(talent.bambooScore).appendTo(li);
            	$('<img>').addClass('bamboo-score').appendTo(li);
            	//$('<span>').text('만족도: ').appendTo(li);
                li.click(function() {
                    location.href = '/talent/talents/' + talent.talentNo;
                });
            });
        }
    });
    
    $.ajax({
    	url:"/board/update-lower-category-list-by-upper-category-no",
        type: 'get',
    	data: {upperCategoryNo : upperCategoryNo},
    	dataType:'json',
    	success:function(lowerCategoryList){
    		console.log(lowerCategoryList);
    		$('#lower-category-list').empty();
    		$('#lower-category-list').append($('<option>').text('==중분류 선택=='));
    		lowerCategoryList.forEach(function(lowerCategory){
    			$('#lower-category-list').append($('<option>').val(lowerCategory.categoryNo).text(lowerCategory.item));
    		});
    	}
    });
}


	$('#lower-category-list').on('change', function() { 
		var lowerCategoryNo = $(this).val();
		$.ajax({
			url:"/board/update-talent-list-by-lower-category-no",
	        type: 'get',
			data: {lowerCategoryNo : lowerCategoryNo},
			dataType:'json',
			success:function(talentList){
	            $('#defalut-list').empty();
	            console.log(talentList);
	            talentList.forEach(function(talent){
	            	const li = $('<li>').appendTo('#defalut-list').addClass('talent-ajax-list');
	                $('<img>').attr('src', talent.mainImg).addClass('talent-image').appendTo(li);
	                $('<span>').addClass('talent-title').text(talent.title).appendTo(li);
	                $('<span>').addClass('talent-summary').text(talent.summary).appendTo(li);
	                $('<span>').addClass('talent-seller').text(talent.sellerId).appendTo(li);
	                $('<span>').addClass('talent-price').text(talent.bamboo).appendTo(li);
	                $('<span>').addClass('talent-sale-price').text(talent.saleBamboo).appendTo(li);
	                $('<span>').addClass('talent-score').text(talent.bambooScore).appendTo(li);
	                li.click(function() {
	                    location.href = '/talent/talents/' + talent.talentNo;
	                });
	            });
	        }
		});
	});

	

 /* 별점평균에 따라 나타내는 밤부 스코어 */
$(function rivewImg() {
  var starImages = ['bamboo0.png', 'bamboo0.5.png', 'bamboo1.png', 'bamboo1.5.png', 'bamboo2.png', 
	  'bamboo2.5.png', 'bamboo3.png', 'bamboo3.5.png', 'bamboo4.png', 'bamboo4.5.png', 'bamboo5.png'];
  $('.avgScoreSpan').each(function(){
      var score = parseFloat($(this).text());
      if (score > 5) score = 5; // score가 5보다 크면 5로 고정
      var index;
      if (score == 0) {
        index = 0;
      } else if (score == 0.5) {
        index = 1;
      } else if (score == 1) {
        index = 2;
      } else if (score == 1.5) {
        index = 3;
      } else if (score == 2) {
        index = 4;
      } else if (score == 2.5) {
        index = 5;
      } else if (score == 3) {
        index = 6;
      } else if (score == 3.5) {
        index = 7;
      } else if (score == 4) {
        index = 8;
      } else if (score == 4.5) {
        index = 9;
      } else { // score가 5일 때
        index = 10;
      }
      $(this).next('.bamboo-score').attr('src', '../images/bambooScore/' + starImages[index]);
  });
});
 
	/* $(document).ready(function(){
		$('.topCategoryList').on('DOMSubtreeModified',rivewImg);
	})  */

</script>
</body>
</html>
